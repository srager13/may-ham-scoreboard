
# ============================================
# LOAD BALANCING CONFIGURATION (MULTI-BACKEND)
# ============================================

# File: /etc/nginx/conf.d/upstream.conf
# Use this if you have multiple backend/frontend servers

# For 3 backend servers with health checks
upstream golf_api_backend_ha {
    least_conn;

    # Primary backend
    server backend-1.internal:8080 max_fails=5 fail_timeout=30s;
    # Secondary backends
    server backend-2.internal:8080 max_fails=5 fail_timeout=30s;
    server backend-3.internal:8080 max_fails=5 fail_timeout=30s;

    # Backup server (used only if primary servers are down)
    server backup.internal:8080 backup max_fails=5 fail_timeout=30s;

    keepalive 64;
}

upstream golf_frontend_ha {
    server frontend-1.internal:3000 max_fails=3 fail_timeout=30s;
    server frontend-2.internal:3000 max_fails=3 fail_timeout=30s;
    keepalive 32;
}